(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52683,e=>{"use strict";e.s(["default",()=>o],52683);var t=e.i(43476),s=e.i(71645);function a(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class r{getData(){return this._data}isMessage(){return"message"===this._type}getType(){return this._type}serialize(){return JSON.stringify({type:this._type,data:this._data})}constructor(...e){if(a(this,"_data",void 0),a(this,"_type",void 0),1===e.length){let t=JSON.parse(e[0]);if(!t.type)throw Error("invalid payload");this._data=t.data,this._type=t.type}else this._data=e[1],this._type=e[0]}}class n extends r{isClientAction(){return"client-action"===this._data.group}isServerResponse(){return"server-response"===this._data.group}getGroup(){return this._data.group}getName(){return this._data.name}getStatus(){return this._data.status}isError(){return!this._data.status||this._data.status>0}getData(){return this._data.data}constructor(e){super("message",e)}}let l={players:{},timer:0,breakTimer:0,round:0,winner:null,state:"",question:""},i=e=>{let{id:a,name:i,setRoomId:o,roomId:d}=e,[c,u]=(0,s.useState)(l),[m,p]=(0,s.useState)(null),[h,x]=(0,s.useState)(null),[g,f]=(0,s.useState)(!1),[b,y]=(0,s.useState)(""),[j,N]=(0,s.useState)([]),v=(0,s.useCallback)(()=>{let e=new WebSocket("ws://localhost:8080/ws");e.onopen=t=>{x(e),e.send(JSON.stringify({type:"upgrade",data:{id:a,name:i,token:"12345"}}))},e.onmessage=e=>{let t=new r(e.data);if("ping"!==t.getType()){if("frame"===t.getType())return void u(t.getData());if("handshake"===t.getType())return void p(t.getData());if(t.isMessage()){let e=new n(t.getData());switch(N(t=>[...t,e]),e.getName()){case"start-test-suite":o(e.getData().roomId);return;case"upgrade-success":f(!0);return;case"submit":e.getData().isCorrect&&y("");return}}console.log(t)}};let t=()=>{x(null),p(""),y(""),f(!1),u(l)};return e.onerror=e=>{t()},e.onclose=()=>{t()},e},[]),w=(e,t)=>{null==h||h.send(new n({group:"client-action",name:e,data:t}).serialize())};return(0,s.useEffect)(()=>{v()},[]),(0,t.jsxs)("div",{className:"flex flex-col border min-w-[200px] p-4 rounded-lg",children:[(0,t.jsxs)("h1",{className:"mb-4 font-bold",children:["Connection ",i]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2 mb-4",children:[d?(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("p",{className:"text-xs",children:["id: ",d]}),(0,t.jsx)("button",{onClick:()=>{w("join-test-suite",{roomId:d})},className:"border p-1 rounded-lg",children:"Join"})]}):(0,t.jsx)("button",{className:"border rounded-lg p-1",onClick:()=>w("start-test-suite",{}),children:"Create Room"}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>{w("ready",!0)},className:"border p-1 rounded-lg",children:"Ready"}),(0,t.jsx)("button",{onClick:()=>{w("ready",!1)},className:"border p-1 rounded-lg",children:"Cancel Ready"})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("input",{value:b,placeholder:"send answer",onChange:e=>y(e.target.value),className:"border p-1 rounded-lg",type:"text"}),(0,t.jsx)("button",{onClick:()=>{w("submit",b)},className:"border p-1 rounded-lg",children:"Submit"})]})]}),(0,t.jsx)("div",{children:Object.entries(c).map(e=>{let[s,a]=e;return"players"===s?(0,t.jsxs)("div",{className:"flex flex-col space-x-2",children:[(0,t.jsx)("h2",{className:"font-semibold",children:s}),(0,t.jsx)("pre",{className:"bg-gray-100 w-[300px] overflow-auto text-xs p-2 rounded-lg",children:JSON.stringify(a,null,2)})]},s):(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)("h2",{className:"font-semibold",children:[s,":"]}),(0,t.jsx)("pre",{children:JSON.stringify(a,null,2)})]},s)})}),(0,t.jsx)("h2",{className:"font-semibold mt-6",children:"Incoming Msg"}),(0,t.jsx)("div",{className:"flex flex-col overflow-auto max-w-[300px] max-h-[200px] py-2",children:j.toReversed().map((e,s)=>(0,t.jsx)("pre",{className:"text-xs ".concat(0===s&&"bg-yellow-100"),children:JSON.stringify(e,null,2)},s))})]})};function o(){let[e,a]=(0,s.useState)(""),[r,n]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{if("no"===localStorage.getItem("showTips"))return void n(!1);n(!0)},[]),(0,t.jsxs)(t.Fragment,{children:[r&&(0,t.jsx)("div",{style:{position:"fixed",width:"100vw",height:"100vh",background:"rgba(0,0,0,0.5)"},className:"backdrop-blur min-h-screen w-full flex items-center justify-center fixed top-0 left-0",children:(0,t.jsxs)("div",{className:"bg-[rgb(255,255,255)] px-6 py-4 rounded-lg max-w-[420px]",children:[(0,t.jsx)("h1",{className:"font-semibold mb-4 text-lg",children:"Tips"}),(0,t.jsxs)("p",{className:"text-gray-800",children:["This test suite create 3 current connections. you can simulate actions by clicking controls buttons. ",(0,t.jsx)("br",{})," One of the peer must create the room and 2 other can just Join. ",(0,t.jsx)("br",{})," Try console.log player actions in the server side to see what they are sending."]}),(0,t.jsx)("button",{className:"border rounded-lg px-4 py-2 mt-4 cursor-pointer w-full text-center",onClick:()=>{n(!1),localStorage.setItem("showTips","no")},children:"Close"})]})}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-4 p-4",children:[(0,t.jsx)(i,{setRoomId:a,roomId:e,id:"1",name:"p1"}),(0,t.jsx)(i,{setRoomId:a,roomId:e,id:"2",name:"p2"}),(0,t.jsx)(i,{setRoomId:a,roomId:e,id:"3",name:"p3"})]})]})}}]);